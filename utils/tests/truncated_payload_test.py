payload_to_test = '</>;title="General Info";ct=0,</qlink/searchdevice>;title="searchdevice";obs,</qlink/netinfo>;title="netinfo";obs,</qlink/searchack>;title="searchack";obs,</device/command/unbind>;title="unbind";obs,</device/command/file>;title="file";obs,</aoslink/Discovery>;title="discovery";obs,</device/command/log>;title="log";obs,</device/command/selfdetect>;title="selfdetect";obs,</qlink/searchdevice?true>;title="searchdevice?true";obs,</qlink/searchRouter?true>;title="searchRouter?true";obs,</qlink/guide?true>;title="guide?true";obs,</qlink/request?true>;title="request?true";obs,</device/inform/data>;title="data";obs,</qlink/regist?true>;title="regist?true";obs,</qlink/success?true>;title="success?true";obs,</apdevice/control/WiFiParameterSync>;title="WiFiParameterSync";obs,</apdevice/control/WiFiSwitch>;title="WiFiSwitch";obs,</apdevice/control/RadioConfig>;title="RadioConfig";obs,</apdevice/control/WPS>;title="WPS";obs,</apdevice/control/MacFilter>;title="MacFilter";obs,</apdevice/control/Reboot>;title="Reboot";obs,</apdevice/control/LEDControl>;title="LEDControl";obs,</apdevice/control/RoamingConfig>;title="RoamingConfig";obs,</apdevice/query/ApConfigInfo>;title="ApConfigInfo";obs,</apdevice/query/UplinkStatus>;title="UplinkStatus";obs,</apdevice/query/STAInfo>;title="STAInfo";obs,</apdevice/query/WiFiStats>;title="WiFiStats";obs,</apdevice/query/WiFiStatus>;title="WiFiStatus";obs,</apdevice/query/WlanNeighborInfo>;title="WlanNeighborInfo";obs,</ao'

raw_coap_message = '60457d70c128ff3c2f3e3b7469746c653d2247656e6572616c20496e666f223b63743d302c3c2f716c696e6b2f7365617263686465766963653e3b7469746c653d22736561726368646576696365223b6f62732c3c2f716c696e6b2f6e6574696e666f3e3b7469746c653d226e6574696e666f223b6f62732c3c2f716c696e6b2f73656172636861636b3e3b7469746c653d2273656172636861636b223b6f62732c3c2f6465766963652f636f6d6d616e642f756e62696e643e3b7469746c653d22756e62696e64223b6f62732c3c2f6465766963652f636f6d6d616e642f66696c653e3b7469746c653d2266696c65223b6f62732c3c2f616f736c696e6b2f446973636f766572793e3b7469746c653d22646973636f76657279223b6f62732c3c2f6465766963652f636f6d6d616e642f6c6f673e3b7469746c653d226c6f67223b6f62732c3c2f6465766963652f636f6d6d616e642f73656c666465746563743e3b7469746c653d2273656c66646574656374223b6f62732c3c2f716c696e6b2f7365617263686465766963653f747275653e3b7469746c653d227365617263686465766963653f74727565223b6f62732c3c2f716c696e6b2f736561726368526f757465723f747275653e3b7469746c653d22736561726368526f757465723f74727565223b6f62732c3c2f716c696e6b2f67756964653f747275653e3b7469746c653d2267756964653f74727565223b6f62732c3c2f716c696e6b2f726571756573743f747275653e3b7469746c653d22726571756573743f74727565223b6f62732c3c2f6465766963652f696e666f726d2f646174613e3b7469746c653d2264617461223b6f62732c3c2f716c696e6b2f7265676973743f747275653e3b7469746c653d227265676973743f74727565223b6f62732c3c2f716c696e6b2f737563636573733f747275653e3b7469746c653d22737563636573733f74727565223b6f62732c3c2f61706465766963652f636f6e74726f6c2f57694669506172616d6574657253796e633e3b7469746c653d2257694669506172616d6574657253796e63223b6f62732c3c2f61706465766963652f636f6e74726f6c2f576946695377697463683e3b7469746c653d2257694669537769746368223b6f62732c3c2f61706465766963652f636f6e74726f6c2f526164696f436f6e6669673e3b7469746c653d22526164696f436f6e666967223b6f62732c3c2f61706465766963652f636f6e74726f6c2f5750533e3b7469746c653d22575053223b6f62732c3c2f61706465766963652f636f6e74726f6c2f4d616346696c7465723e3b7469746c653d224d616346696c746572223b6f62732c3c2f61706465766963652f636f6e74726f6c2f5265626f6f743e3b7469746c653d225265626f6f74223b6f62732c3c2f61706465766963652f636f6e74726f6c2f4c4544436f6e74726f6c3e3b7469746c653d224c4544436f6e74726f6c223b6f62732c3c2f61706465766963652f636f6e74726f6c2f526f616d696e67436f6e6669673e3b7469746c653d22526f616d696e67436f6e666967223b6f62732c3c2f61706465766963652f71756572792f4170436f6e666967496e666f3e3b7469746c653d224170436f6e666967496e666f223b6f62732c3c2f61706465766963652f71756572792f55706c696e6b5374617475733e3b7469746c653d2255706c696e6b537461747573223b6f62732c3c2f61706465766963652f71756572792f535441496e666f3e3b7469746c653d22535441496e666f223b6f62732c3c2f61706465766963652f71756572792f5769466953746174733e3b7469746c653d22576946695374617473223b6f62732c3c2f61706465766963652f71756572792f576946695374617475733e3b7469746c653d2257694669537461747573223b6f62732c3c2f61706465766963652f71756572792f576c616e4e65696768626f72496e666f3e3b7469746c653d22576c616e4e65696768626f72496e666f223b6f62732c3c2f616f'

raw_coap_delimeter = raw_coap_message.find('ff')
raw_coap_header_size = raw_coap_delimeter + 2

raw_coap_payload_size = len(raw_coap_message) - raw_coap_header_size

print(len(payload_to_test))
print(raw_coap_payload_size/2)
print(raw_coap_header_size/2)

udp_pkt_size = 1524
udp_header_size = 8 # fixed

if (udp_pkt_size - udp_header_size - (raw_coap_header_size/2) != (raw_coap_payload_size/2)):
    print("Truncated payload: a new discovery must be performed!")
else:
    print("Payload is NOT truncated")

print(udp_pkt_size - udp_header_size - (raw_coap_header_size/2))

